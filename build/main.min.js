!function t(i,e,n){function o(a,s){if(!e[a]){if(!i[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var f=e[a]={exports:{}};i[a][0].call(f.exports,function(t){var e=i[a][1][t];return o(e?e:t)},f,f.exports,t,i,e,n)}return e[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,i,e){var n=t("./modules/Game");window.initGame=function(){"undefined"!=typeof this.gameLoop&&this.cancelAnimationFrame(this.gameLoop);var t=new n;t.init()},initGame()},{"./modules/Game":3}],2:[function(t,i,e){i.exports=function(t,i,e,n,o){var r=!1,a=new Image;a.src="images/button.png",a.onload=function(){r=!0,t-=this.width/2,i-=this.height/2,n.add(t,i,this.width,this.height,{onclick:o})},this.draw=function(n){r&&(n.drawImage(a,t,i),n.font="bold 20px verdana",n.fillStyle="#ffffff",n.fillText(e,t+(a.width/2-n.measureText(e).width/2),i+35))}}},{}],3:[function(t,i,e){var n=t("./Tile"),o=t("./Player"),r=t("./GameOver");i.exports=function(){var t,i,e,a=$("canvas#game"),s=[],u=10,h=!1,f=new function(){var t=[];this.add=function(i,e,n,o,r){return t.push([i,e,i+n,e+o,r])},this.clear=function(){t=[]},this["do"]=function(i){if(!t.length)return!1;for(var e in t){if(!t.hasOwnProperty(e))return!1;if(i.offsetX>=t[e][0]&&i.offsetX<=t[e][2]&&i.offsetY>=t[e][1]&&i.offsetY<=t[e][3])for(var n in t[e][4])"on"+i.type==n&&"function"==typeof t[e][4][n]&&t[e][4][n]();else for(var n in t[e][4])"onmouseout"==n&&"function"==typeof t[e][4][n]&&t[e][4].onmouseout()}}};this.inited=!1,window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame}()),this.tick=function(){window.gameLoop=window.requestAnimationFrame(this.tick.bind(this)),this.update(),this.render()},this.update=function(){for(var t=s.length;t--;)s[t].update();h&&h.update()},this.render=function(){t.clearRect(0,0,a[0].width,a[0].height);for(var i=s.length;i--;)s[i].draw(t);h&&h.draw(t)},this.onmousedown=function(t){return h?!1:s[t].isFlipped()?!1:(s[t].onmouseout(),void this.doMovement(t))},this.doMovement=function(t){var n=i.move?i:e,o=i.move?e:i;s[t].flip(n.shape),n.moves++;var r=this.checkWin(t,n);return r?this.gameOver(n,r):(n.move=!1,void(o.move=!0))},this.checkWin=function(t,i){if(i.moves<5)return!1;for(var e=[[[-1,-1],[1,1]],[[1,-1],[-1,1]],[[0,-1],[0,1]],[[-1,0],[1,0]]],n=t%u,o=Math.floor(t/u),r=e.length;r--;){var a=-1,h=n,f=o,c=[];for(c[t]=!0;s[h+f*u].equals(i.shape)&&(a++,c[h+f*u]=!0,h+=e[r][0][0],f+=e[r][0][1],!(0>h||0>f||h>=u||f>=u)););for(h=n,f=o;s[h+f*u].equals(i.shape)&&(a++,c[h+f*u]=!0,h+=e[r][1][0],f+=e[r][1][1],!(0>h||0>f||h>=u||f>=u)););if(a>=5)return c}return!1},this.gameOver=function(t,i){this.inited=!1;for(var e=a.width()/2,n=s.length;n--;)"undefined"!=typeof i[n]?(s[n].center(e-25),s[n].slide({x:e-25,y:110})):s[n].hide();f.clear(),h=new r(t.shape,e,f)},this.init=function(){this.inited=!0,a[0].width=a[0].height=59*u+10,i=new o,e=new o,i.move=!0,i.shape="nought",a.unbind("click mousemove mouseout").bind("click mousemove mouseout",f["do"]),t=a[0].getContext("2d");for(var r=0;u>r;r++)for(var h=0;u>h;h++){var c=59*h+10,d=59*r+10,m=s.push(new n(c,d,"blank"));!function(t,i){f.add(c,d,50,50,{onclick:i.onmousedown.bind(i,t),onmousemove:s[t].onmousemove.bind(s[t]),onmouseout:s[t].onmouseout.bind(s[t])})}(--m,this)}this.tick()}}},{"./GameOver":4,"./Player":5,"./Tile":6}],4:[function(t,i,e){var n=t("./Button");i.exports=function(t,i,e){var o=0,r=!1,a=[];this.update=function(){1>o&&r&&(o+=.04,o=Math.min(1,o))},this.draw=function(e){e.save();var n="The "+t+" player won!";e.globalAlpha=o,e.font="40px verdana",e.shadowColor="black",e.shadowBlur=7,e.lineWidth=4,e.strokeText(n,i-e.measureText(n).width/2,280),e.shadowBlur=0,e.fillStyle="#bbb3c6",e.fillText(n,i-e.measureText(n).width/2,280),e.restore();for(var r=a.length;r--;)a[r].draw(e)},this.init=function(){r=!0,a=[new n(i,430,"Play again",e,initGame.bind(window))]},setTimeout(this.init,1700)}},{"./Button":2}],5:[function(t,i,e){i.exports=function(){this.move=!1,this.moves=0,this.shape="cross"}},{}],6:[function(t,i,e){i.exports=function(t,i,e){var n,o,r=50,a=0,s=!1,u=1,h=0;this.update=function(){if(a>0&&(a-=.05),u>0&&1>u&&this.hide(),o){if(t==o.x&&i==o.y)return h=0,void(o=!1);o.x!=t&&(o.x>t?t+=h:t-=h),o.y!=i&&(o.y>i?i+=h:i-=h),Math.abs(o.x-t)<h&&(t=o.x),Math.abs(o.y-i)<h&&(i=o.y)}},this.draw=function(o){if(0!=u){if(0>=a)return o.globalAlpha=u,void o.drawImage(n,t,i);for(var s=2,h=this.init(a>.5?"blank":e),f=-Math.abs(2*a-1)+1,c=0;r>c;c+=s){var d=a>.5?c:r-c;o.drawImage(h,c,0,s,r,t+c-f*c+r/2*f,i-d*f*.2,s,r+d*f*.4)}}},this.onmousemove=function(){this.isFlipped()||s||(s=!0,n=this.init(e))},this.onmouseout=function(){s&&(s=!1,n=this.init(e))},this.flip=function(t){n=this.init(t),e=t,a=1},this.hide=function(){u-=.05,u=Math.max(u,0)},this.center=function(e,n){h=Math.sqrt(Math.pow(t-e,2)+Math.pow(i-e,2))/30,o={x:e,y:e,fun:n}},this.slide=function(t){setTimeout(function(){h=3,o={x:t.x,y:t.y}},1200)},this.isFlipped=function(){return"blank"!==e},this.equals=function(t){return e==t},this.init=function(t){var i=$("<canvas/>",{width:r,height:r})[0],e=i.getContext("2d");switch(e.fillStyle=s?"#725f8c":"#bbb3c6",e.lineWidth=4,e.strokeStyle="white",e.fillRect(0,0,r,r),t){case"blank":break;case"cross":e.beginPath(),e.moveTo(10,10),e.lineTo(40,40),e.moveTo(40,10),e.lineTo(10,40),e.stroke();break;case"nought":e.beginPath(),e.arc(r/2,r/2,16,0,2*Math.PI),e.stroke()}var n=new Image;return n.src=i.toDataURL(),n},n=this.init(e)}},{}]},{},[1]);
